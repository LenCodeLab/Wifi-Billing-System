<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wi-Fi Billing System</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>FastNet Wi-Fi</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="login.html">Login</a>
      <a href="pay.html">Payment</a>
    </nav>
  </header>

<!-- ... rest of your HTML ... -->
<main>
  <h2>Internet Packages</h2>
  <label for="phone">Enter your phone number:</label>
  <input type="text" id="phone" placeholder="e.g. 0712345678" />
  <div class="packages">
    <div class="package" data-package="daily">
      <h3>Daily</h3>
      <p>1GB @ KES 20</p>
      <button class="buy-btn">Buy Now</button>
    </div>
    <div class="package" data-package="weekly">
      <h3>Weekly</h3>
      <p>5GB @ KES 80</p>
      <button class="buy-btn">Buy Now</button>
    </div>
    <div class="package" data-package="monthly">
      <h3>Monthly</h3>
      <p>20GB @ KES 300</p>
      <button class="buy-btn">Buy Now</button>
    </div>
  </div>
  <div id="status"></div>
</main>
  <script>document.querySelectorAll('.buy-btn').forEach(btn => {
  btn.addEventListener('click', async function(e) {
    const packageDiv = btn.closest('.package');
    const packageType = packageDiv.getAttribute('data-package');
    const phone = document.getElementById('phone').value.trim();
    const statusDiv = document.getElementById('status');
    statusDiv.textContent = '';

    if (!phone.match(/^07\d{8}$/)) {
      statusDiv.textContent = 'Please enter a valid Kenyan phone number (e.g., 0712345678)';
      return;
    }

    // Optionally, you may want to auto-detect MAC (advanced, usually passed from backend)
    // For now, just send phone and package type
    btn.disabled = true;
    btn.textContent = 'Processing...';

    try {
      const response = await fetch('/api/subscribe', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          phone: phone,
          package: packageType
          // Add mac_address if available
        })
      });

      const data = await response.json();
      if (data.success) {
        statusDiv.textContent = 
          'STK Push sent to your phone. Complete payment to activate your internet package.';
      } else {
        statusDiv.textContent = data.message || 'Sorry, something went wrong.';
      }
    } catch (err) {
      statusDiv.textContent = 'Network error. Please try again.';
    } finally {
      btn.disabled = false;
      btn.textContent = 'Buy Now';
    }
  });
});</script>
<!-- ... rest of your HTML ... -->
